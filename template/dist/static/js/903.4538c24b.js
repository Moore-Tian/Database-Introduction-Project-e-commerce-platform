"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[903],{1903:function(t,s,o){o.r(s),o.d(s,{default:function(){return n}});var a=function(){var t=this,s=t._self._c;return t.product?s("div",[s("div",{staticClass:"product"},[s("div",{staticClass:"product-image"},[s("img",{attrs:{src:`http://127.0.0.1:8000/media/${t.product.fields.product_image}`,alt:""}})]),s("div",{staticClass:"product-info"},[s("h1",{staticClass:"product-name"},[t._v(t._s(t.product.fields.product_name))]),s("div",{staticClass:"product-cost"},[t._v("商品库存："+t._s(t.product.fields.product_stock))]),s("div",{staticClass:"product-cost"},[t._v("商品销量："+t._s(t.product.fields.product_sales))]),s("div",{staticClass:"product-cost"},[t._v("商品单价："+t._s(t.product.fields.product_cost))]),s("div",{staticClass:"product-cost"},[t._v("商品品牌："+t._s(t.product.fields.product_brand))]),s("div",{staticClass:"product-cost"},[t._v("商品颜色："+t._s(t.product.fields.product_color))]),s("div",{staticClass:"product-add-cart",on:{click:t.handleAddCart}},[t._v("加入购物车")]),s("div",[t.begood?s("span",{staticClass:"fillheart",on:{click:t.changeGood}},[s("font-awesome-icon",{staticClass:"icon righticon",attrs:{icon:["fas","heart"]}})],1):t._e(),t.begood?t._e():s("span",{staticClass:"heart",on:{click:t.changeGood}},[s("font-awesome-icon",{staticClass:"icon righticon",attrs:{icon:["fas","heart"]}})],1),s("span",{staticClass:"word"},[t._v(t._s(t.product_goods))])])])]),s("div",{staticClass:"product-desc"},[s("h2",[t._v("商家详情")]),s("router-link",{attrs:{to:"/shop/"+t.product.fields.product_business}},[t._v(" 点击进入商家主页 ")]),s("div",[t.bestar?s("span",{staticClass:"fillstar",on:{click:t.changeStar}},[s("font-awesome-icon",{staticClass:"icon righticon",attrs:{icon:["fas","star"]}})],1):t._e(),t.bestar?t._e():s("span",{staticClass:"star",on:{click:t.changeStar}},[s("font-awesome-icon",{staticClass:"icon righticon",attrs:{icon:["fas","star"]}})],1),s("span",{staticClass:"word"},[t._v(t._s(t.shop_stars))])])],1),s("div",{staticClass:"product-desc"},[s("h2",[t._v("产品介绍")]),s("img",{attrs:{src:`http://127.0.0.1:8000/media/${t.product.fields.product_imageDetail}`,alt:""}})])]):t._e()},i=[],c={data(){return{id:parseInt(this.$route.params.id),product:null,product_goods:0,begood:!0,bestar:!0,shop_stars:0}},methods:{async getProductLikes(){await this.axios.get("get_product_likes/",{params:{product_id:this.id}}).then((t=>{console.log(t),this.product_goods=t.data.goods})).catch((function(t){console.log(t)})),await this.axios.get("get_shop_stars/",{params:{business_id:this.product.fields.product_business}}).then((t=>{console.log(t),this.shop_stars=t.data.stars})).catch((function(t){console.log(t)}))},async changeGood(){this.begood?this.product_goods-=1:this.product_goods+=1,this.begood=!this.begood,await this.axios.get("toggle_user_like_to_product/",{params:{user_id:this.$store.state.userId,product_id:this.id}}).then((t=>{console.log(t)})).catch((function(t){console.log(t)}))},async changeStar(){this.bestar?this.shop_stars-=1:this.shop_stars+=1,this.bestar=!this.bestar,await this.axios.get("toggle_user_star_to_shop/",{params:{user_id:this.$store.state.userId,business_id:this.product.fields.product_business}}).then((t=>{console.log(t)})).catch((function(t){console.log(t)}))},async initUserToProduct(){await this.axios.get("get_user_like_to_product/",{params:{user_id:this.$store.state.userId,product_id:this.id}}).then((t=>{console.log(t),"good"===t.data.good?this.begood=!0:this.begood=!1})).catch((function(t){console.log(t)})),await this.axios.get("get_user_star_to_shop/",{params:{user_id:this.$store.state.userId,business_id:this.product.fields.product_business}}).then((t=>{console.log(t),"star"===t.data.star?this.bestar=!0:this.bestar=!1})).catch((function(t){console.log(t)}))},async getProduct(t){await this.axios.get("fetch_product/",{params:{product_id:t}}).then((t=>{console.log(t),this.product=t.data.product})).catch((function(t){console.log(t)}))},async handleAddCart(){await this.axios.get("add_to_cart/",{params:{user_id:this.$store.state.userId,product_id:this.id}}).then((t=>{console.log(t),window.alert("添加成功")})).catch((function(t){console.log(t)}))}},async created(){console.log("detailview"),console.log(this.id),await this.getProduct(this.id),console.log("detailviewend"),console.log(this.product),await this.initUserToProduct(),await this.getProductLikes()},async mounted(){console.log("11detailview"),console.log(this.id),await this.getProduct(this.id),console.log("11detailviewend"),console.log(this.product)}},e=c,d=o(1001),r=(0,d.Z)(e,a,i,!1,null,"ec46d19c",null),n=r.exports}}]);
//# sourceMappingURL=903.4538c24b.js.map