"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[351],{7351:function(t,e,s){s.r(e),s.d(e,{default:function(){return S}});var a=s(6190),o=s(322),r=s(2118),i=s(2180),n=s(4324),c=s(5808),l=s(4525),d=s(6098),u=s(9608),p=s(1713),f=s(3687),h=s(6313),g=s(7953),m=function(){var t=this,e=t._self._c;return e("div",[e(r.Z,{attrs:{fluid:""}},[e(i.Z,{attrs:{items:t.productsList,"items-per-page":t.itemsPerPage,page:t.page,search:t.search,"hide-default-footer":""},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}},scopedSlots:t._u([{key:"header",fn:function(){return[e(h.Z,{staticClass:"mb-1",attrs:{dark:"",color:"pink lighten-3"}},[e(f.Z),e(g.qW,[e("h4",[t._v("上架商品")])]),e(f.Z)],1)]},proxy:!0},{key:"default",fn:function(s){return[e(p.Z,t._l(s.items,(function(t){return e(o.Z,{key:t.fields.product_name},[e("business_Product",{key:t.fields.id,attrs:{info:t}})],1)})),1)]}},{key:"footer",fn:function(){return[e(p.Z,{staticClass:"mt-2",attrs:{align:"center",justify:"center"}},[e("span",{staticClass:"grey--text"},[t._v("Items per page")]),e(u.Z,{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:o}){return[e(a.Z,t._g(t._b({staticClass:"ml-2",attrs:{dark:"",text:"",color:"primary"}},"v-btn",o,!1),s),[t._v(" "+t._s(t.itemsPerPage)+" "),e(n.Z,[t._v("mdi-chevron-down")])],1)]}}])},[e(c.Z,t._l(t.itemsPerPageArray,(function(s,a){return e(l.Z,{key:a,on:{click:function(e){return t.updateItemsPerPage(s)}}},[e(d.V9,[t._v(t._s(s))])],1)})),1)],1),e(f.Z),e("span",{staticClass:"mr-4 grey--text"},[t._v(" Page "+t._s(t.page)+" of "+t._s(t.numberOfPages)+" ")]),e(a.Z,{staticClass:"mr-1",attrs:{fab:"",dark:"",color:"pink lighten-3"},on:{click:t.formerPage}},[e(n.Z,[t._v("mdi-chevron-left")])],1),e(a.Z,{staticClass:"ml-1",attrs:{fab:"",dark:"",color:"pink lighten-3"},on:{click:t.nextPage}},[e(n.Z,[t._v("mdi-chevron-right")])],1)],1)]},proxy:!0}])})],1),e("div",{staticClass:"container"},[t._v(" "+t._s(t.upload_file||"导入")+" "),e("input",{staticClass:"upload_file",attrs:{type:"file",accept:".xls,.xlsx"},on:{change:function(e){return t.readExcel(e)}}}),e("el-button",{staticStyle:{"background-color":"#FF69B4","border-color":"#FF69B4"},attrs:{type:"success"},on:{click:t.addExcelStock}},[t._v(" 导入excel库存 ")])],1),e(a.Z,{staticClass:"ma-2",attrs:{color:"pink lighten-3"},on:{click:t.addCommodity}},[t._v(" 添加商品 ")])],1)},_=[],P=(s(7658),function(){var t=this,e=t._self._c;return e("div",{staticClass:"product"},[e("router-link",{staticClass:"product-main",attrs:{to:"/business/product/"+t.info.pk}},[e("img",{attrs:{src:`http://127.0.0.1:8000/media/${t.info.fields.product_image}`,alt:"",height:"200px"}}),e("h4",[t._v(t._s(t.info.fields.product_name))]),e("h4",[t._v("销量"+t._s(t.info.fields.product_sales))]),e("div",{staticClass:"product-color",style:{background:t.colors[t.info.fields.product_color]}}),e("div",{staticClass:"product-cost"},[t._v("￥ "+t._s(t.info.fields.product_cost))]),e("div",{staticClass:"product-add-cart",on:{click:function(e){return e.preventDefault(),t.handleAddCart.apply(null,arguments)}}},[t._v("增加库存")])])],1)}),y=[],k={props:{info:Object},data(){return{colors:{"白色":"#ffffff","黑色":"#100f0f","灰色":"#a39f9f","金色":"#dac272","蓝色":"#233472","红色":"#f2352e"}}},methods:{async handleAddCart(){this.$router.push({path:"/business/commodity/edit_commodity_stock/"+this.info.pk})}}},v=k,x=s(1001),b=(0,x.Z)(v,P,y,!1,null,"4c8f1394",null),C=b.exports,w=s(4105),Z={name:"business_commodity",components:{business_Product:C},data(){return{excelParseData:[],itemsPerPageArray:[4,8,12],search:"",page:1,itemsPerPage:4,productsList:[],items:[{name:"手机","库存":1e4,"金额":"5000元"}]}},computed:{numberOfPages(){return Math.ceil(this.productsList.length/this.itemsPerPage)}},methods:{nextPage(){this.page+1<=this.numberOfPages&&(this.page+=1)},formerPage(){this.page-1>=1&&(this.page-=1)},updateItemsPerPage(t){this.itemsPerPage=t},async getProductsList(){await this.axios.get("show_products/").then((t=>{console.log(t.data.list),this.productsList=t.data.list.filter((t=>t.fields.product_business===this.$store.state.userId)),console.log(this.productsList)})).catch((function(t){console.log(t)}))},async addCommodity(){let t=[];return await this.axios.get("fetch_userInfo",{params:{user_id:this.$store.state.userId}}).then((e=>{console.log(e),t=e})).catch((function(t){console.log(t)})),""===t.data.user_mobile?(console.log("null"),window.alert("请完善联系方式"),void this.$router.push({path:"/business/information"})):""===t.data.user_province||""===t.data.user_city||""===t.data.user_area?(window.alert("请完善地址"),void this.$router.push({path:"/business/information"})):""===t.data.user_address?(window.alert("请完善详细地址"),void this.$router.push({path:"/business/information"})):void this.$router.push({path:"/business/commodity/add_commodity"})},addExcelStock(){console.log(this.excelParseData),this.upload_file?(this.excelParseData.forEach((async t=>{await this.axios.get("add_product_stock/",{params:{product_id:t.product_id,stock:t.stock_num,cost:t.stock_cost}}).then((t=>{console.log(t)})).catch((function(t){console.log(t)}))})),this.upload_file=null,this.excelParseData=[],window.alert("库存添加成功")):window.alert("导入文件为空")},readExcel(t){this.excelParseData=[],this.upload_file=null;let e=this;const s=t.target.files;if(s.length<=0)return!1;if(!/\.(xls|xlsx)$/.test(s[0].name.toLowerCase()))return this.$message({message:"上传格式不正确，请上传xls或者xlsx格式",type:"warning"}),!1;e.upload_file=s[0].name;const a=new FileReader;a.onload=e=>{try{const t=e.target.result,s=(0,w.ij)(t,{type:"binary"}),a=s.SheetNames[0],o=w.P6.sheet_to_json(s.Sheets[a]);console.log(o),this.excelParseData=o,console.log(this.excelParseData)}catch(t){return console.log(t),!1}},console.log("rrrttt"),a.readAsBinaryString(s[0])}},async created(){await this.getProductsList(),console.log("this"),console.log(JSON.stringify(this.productsList))}},$=Z,L=(0,x.Z)($,m,_,!1,null,null,null),S=L.exports}}]);
//# sourceMappingURL=351.85f61043.js.map