"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[742],{1828:function(s,t,r){r.d(t,{Z:function(){return c}});var o=function(){var s=this,t=s._self._c;return t("div",{staticClass:"product"},[t("router-link",{staticClass:"product-main",attrs:{to:"/product/"+s.info.pk}},[t("img",{attrs:{src:`http://127.0.0.1:8000/media/${s.info.fields.product_image}`,alt:"",height:"200px"}}),t("h4",[s._v(s._s(s.info.fields.product_name))]),t("h4",[s._v("销量"+s._s(s.info.fields.product_sales))]),t("div",{staticClass:"product-color",style:{background:s.colors[s.info.fields.product_color]}}),t("div",{staticClass:"product-cost"},[s._v("￥ "+s._s(s.info.fields.product_cost))]),t("div",{staticClass:"product-add-cart",on:{click:function(t){return t.preventDefault(),s.handleAddCart.apply(null,arguments)}}},[s._v("加入购物车")])])],1)},e=[],i={props:{info:Object},data(){return{colors:{"白色":"#ffffff","黑色":"#100f0f","灰色":"#a39f9f","金色":"#dac272","蓝色":"#233472","红色":"#f2352e"},product_goods:0,begood:!0}},methods:{async handleAddCart(){await this.axios.get("add_to_cart/",{params:{user_id:this.$store.state.userId,product_id:this.info.pk}}).then((s=>{console.log(s),window.alert("添加成功")})).catch((function(s){console.log(s)}))}}},a=i,l=r(1001),n=(0,l.Z)(a,o,e,!1,null,"54f023da",null),c=n.exports},3742:function(s,t,r){r.r(t),r.d(t,{default:function(){return h}});var o=function(){var s=this,t=s._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:s.list.length,expression:"list.length"}]},[t("div",{staticClass:"list-control"},[t("div",{staticClass:"list-control-filter"},[t("span",[s._v("品牌:")]),s._l(s.brands,(function(r){return t("span",{key:r.index,staticClass:"list-control-filter-item",class:{on:r===s.filterBrand},on:{click:function(t){return s.handleFilterBrand(r)}}},[s._v(s._s(r))])}))],2),t("div",{staticClass:"list-control-filter"},[t("span",[s._v("颜色:")]),s._l(s.colors,(function(r){return t("span",{key:r.index,staticClass:"list-control-filter-item",class:{on:r===s.filterColor},on:{click:function(t){return s.handleFilterColor(r)}}},[s._v(s._s(r))])}))],2),t("div",{staticClass:"list-control-order"},[t("span",[s._v("排序:")]),t("span",{staticClass:"list-control-order-item",class:{on:""===s.order},on:{click:s.handleOrderDefault}},[s._v("默认")]),t("span",{staticClass:"list-control-order-item",class:{on:"sales"===s.order},on:{click:s.handleOrderSales}},[s._v(" 销量 "),"sales"===s.order?[s._v("↓")]:s._e()],2),t("span",{staticClass:"list-control-order-item",class:{on:s.order.indexOf("cost")>-1},on:{click:s.handleOrderCost}},[s._v(" 价格 "),"cost-desc"===s.order?[s._v("↓")]:s._e(),"cost-asc"===s.order?[s._v("↑")]:s._e()],2)]),t("div",[s.bestar?t("span",{staticClass:"fillstar",on:{click:s.changeStarss}},[t("font-awesome-icon",{staticClass:"icon righticon",attrs:{icon:["fas","star"]}})],1):s._e(),s.bestar?s._e():t("span",{staticClass:"star",on:{click:s.changeStarss}},[t("font-awesome-icon",{staticClass:"icon righticon",attrs:{icon:["fas","star"]}})],1),t("span",{staticClass:"word"},[s._v(s._s(s.shop_stars))])])]),t("div",{staticClass:"productsList"},s._l(s.filteredAndOrderedList,(function(s){return t("Customer_Product",{key:s.fields.id,attrs:{info:s}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:!s.filteredAndOrderedList.length,expression:"!filteredAndOrderedList.length"}],staticClass:"product-not-found"},[s._v("暂无相关商品")])])},e=[],i=r(1828),a=r(8491),l={components:{Customer_Product:i.Z},data(){return{id:parseInt(this.$route.params.id),list:[],filterBrand:"",filterColor:"",order:"",bestar:!0,shop_stars:0}},computed:{brands(){console.log("bb22");const s=this.list.map((s=>s.fields.product_brand));return console.log("bbbbb22"),console.log(s),a.Z.getFilterArray(s)},colors(){const s=this.list.map((s=>s.fields.product_color));return a.Z.getFilterArray(s)},filteredAndOrderedList(){let s=[...this.list];return""!==this.filterBrand&&(s=s.filter((s=>s.fields.product_brand===this.filterBrand))),""!==this.filterColor&&(s=s.filter((s=>s.fields.product_color===this.filterColor))),""!==this.order&&("sales"===this.order?s=s.sort(((s,t)=>t.fields.product_sales-s.fields.product_sales)):"cost-desc"===this.order?s=s.sort(((s,t)=>t.fields.product_cost-s.fields.product_cost)):"cost-asc"===this.order&&(s=s.sort(((s,t)=>s.fields.product_cost-t.fields.product_cost)))),s}},methods:{async getProductsList(){await this.axios.get("show_products/").then((s=>{console.log(s.data.list),this.list=s.data.list.filter((s=>s.fields.product_business===this.id))})).catch((function(s){console.log(s)}))},handleFilterBrand(s){this.filterBrand===s?this.filterBrand="":this.filterBrand=s},handleFilterColor(s){this.filterColor===s?this.filterColor="":this.filterColor=s},handleOrderDefault(){this.order=""},handleOrderSales(){this.order="sales"},handleOrderCost(){"cost-desc"===this.order?this.order="cost-asc":this.order="cost-desc"},async changeStarss(){this.bestar?this.shop_stars-=1:this.shop_stars+=1,this.bestar=!this.bestar,await this.axios.get("toggle_user_star_to_shop/",{params:{user_id:this.$store.state.userId,business_id:this.id}}).then((s=>{console.log(s)})).catch((function(s){console.log(s)}))}},async created(){console.log("22"),await this.getProductsList(),console.log(this.list),console.log(this.list.map((s=>s.fields.product_brand))),console.log(this.list[0].pk),await this.handleOrderSales(),await this.axios.get("get_user_star_to_shop/",{params:{user_id:this.$store.state.userId,business_id:this.id}}).then((s=>{console.log(s),"star"===s.data.star?this.bestar=!0:this.bestar=!1})).catch((function(s){console.log(s)})),await this.axios.get("get_shop_stars/",{params:{business_id:this.id}}).then((s=>{console.log(s),this.shop_stars=s.data.stars,console.log(this.shop_stars)})).catch((function(s){console.log(s)}))}},n=l,c=r(1001),d=(0,c.Z)(n,o,e,!1,null,"51d32aec",null),h=d.exports}}]);
//# sourceMappingURL=742.7df179a9.js.map