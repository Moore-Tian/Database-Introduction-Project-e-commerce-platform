{"ast":null,"code":"import { required } from \"@/utils/widget\";\nexport default {\n  name: \"business_add_commodity\",\n  data() {\n    return {\n      productForm: {\n        product_name: \"\",\n        // 商品名\n        product_color: \"\",\n        // 商品颜色\n        // TODO：商品进价/商品售价\n        product_brand: \"\",\n        // 商品库存\n        product_cost: \"\",\n        // 商品库存\n        product_image1: 'http://127.0.0.1:8000/media/avatar/default_pic.jpg',\n        // 主页图片\n        product_image2: 'http://127.0.0.1:8000/media/avatar/default_pic.jpg'\n        // TODO：细节图片\n      },\n\n      showPic1: 'http://127.0.0.1:8000/media/avatar/default_pic.jpg',\n      showPic2: 'http://127.0.0.1:8000/media/avatar/default_pic.jpg',\n      formEmptyRule: [required(\"此栏目\")],\n      costRule: [required(\"此栏目\"), function (v) {\n        return /^(([1-9]{1}\\d*)|(0{1}))(\\.\\d{1,2})?$/.test(v) || `金额最多两位小数`;\n      }]\n    };\n  },\n  methods: {\n    // TODO：保存商品信息\n    async saveProduct() {\n      let formData = new FormData();\n      formData.append('product_image1', this.productForm.product_image1);\n      formData.append('product_image2', this.productForm.product_image2);\n      const json = JSON.stringify(this.productForm);\n      const blob = new Blob([json], {\n        type: 'application/json'\n      });\n      formData.append('forms', blob);\n      const json2 = JSON.stringify(this.$store.state.userId);\n      const blob2 = new Blob([json2], {\n        type: 'application/json'\n      });\n      formData.append('user_id', blob2);\n      console.log(\"blob2\");\n      console.log(blob2);\n      console.log(JSON.stringify(this.$store.state.user_id));\n      var configs = {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      };\n      await this.axios.post('add_product/', formData, configs).then(response => {\n        console.log(formData.get('forms'));\n        if (response.data.msg === \"success\") {\n          //this.showPic1 = 'http://127.0.0.1:8000/media/'+response.data.image1\n          //this.showPic2 = 'http://127.0.0.1:8000/media/'+response.data.image2\n          console.log(response);\n          window.location.href = '/#/business/commodity';\n          window.alert(\"商品成功上架\");\n        }\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    getImageFile1: function (e) {\n      this.productForm.product_image1 = e.target.files[0];\n      let img = new FileReader();\n      img.readAsDataURL(this.productForm.product_image1);\n      console.log(\"img:\", img);\n      img.onload = ({\n        target\n      }) => {\n        this.showPic1 = target.result; //将img转化为二进制数据\n        console.log(\"target:\", target);\n      };\n    },\n    getImageFile2: function (e) {\n      this.productForm.product_image2 = e.target.files[0];\n      let img = new FileReader();\n      img.readAsDataURL(this.productForm.product_image2);\n      console.log(\"img:\", img);\n      img.onload = ({\n        target\n      }) => {\n        this.showPic2 = target.result; //将img转化为二进制数据\n        console.log(\"target:\", target);\n      };\n    },\n    async onSubmit() {\n      console.log(\"good\");\n    },\n    clear() {\n      this.productForm = {\n        product_name: \"\",\n        // 商品名\n        product_color: \"\",\n        // 商品颜色\n        // TODO：商品进价/商品售价\n        product_brand: \"\",\n        // 商品库存\n        product_cost: \"\",\n        // 商品库存\n        product_image1: \"\",\n        // 主页图片\n        product_image2: \"\"\n        // TODO：细节图片\n      }, this.showPic1 = \"\", this.showPic2 = \"\";\n    }\n  }\n};","map":{"version":3,"mappings":"AAqHA;AAEA;EACAA;EACAC;IACA;MACAC;QACAC;QAAA;QACAC;QAAA;QACA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QACA;MACA;;MACAC;MACAC;MACAC;MACAC,4BACA;QACA;MACA;IAGA;EACA;EAEAC;IACA;IACA;MACA;MACAC;MACAA;MAEA;MACA;QACAC;MACA;MAEAD;MAEA;MACA;QACAC;MACA;MAEAD;MACAE;MACAA;MACAA;MAEA;QACAC;UAAA;QAAA;MACA;MAEA;QACAD;QACA;UACA;UACA;UACAA;UAKAE;UACAA;QAEA;QACAF;MACA,GACAG;QACAH;MACA;IAEA;IACAI;MACA;MACA;MACAC;MACAL;MACAK;QAAAC;MAAA;QACA;QACAN;MACA;IACA;IACAO;MACA;MACA;MACAF;MACAL;MACAK;QAAAC;MAAA;QACA;QACAN;MACA;IACA;IACA;MACAA;IACA;IACAQ;MACA;QACArB;QAAA;QACAC;QAAA;QACA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QACA;MACA,GACA,oBACA;IACA;EACA;AACA","names":["name","data","productForm","product_name","product_color","product_brand","product_cost","product_image1","product_image2","showPic1","showPic2","formEmptyRule","costRule","methods","formData","type","console","headers","window","catch","getImageFile1","img","target","getImageFile2","clear"],"sourceRoot":"src/view/business","sources":["business_add_commodity.vue"],"sourcesContent":["<template>\n  <div class=\"py-2 px-2 height-100pc user-center\" elevation=\"1\">\n    <v-row no-gutters justify=\"space-between\">\n      <v-col class=\"ml-3\">\n        <v-toolbar\n            dark\n            color=\"pink lighten-3\"\n            class=\"mb-1\"\n        >\n          <v-spacer></v-spacer>\n          <v-toolbar-title>\n            <h4>添加商品</h4>\n          </v-toolbar-title>\n          <v-spacer></v-spacer>\n        </v-toolbar>\n        <v-card>\n          <v-card flat class=\"pa-3\">\n            <v-row>\n              <v-col md=\"6\">\n                <v-form ref=\"form\">\n                  <!-- 字段渲染 -->\n                  <v-container>\n                    <v-row>\n                      <v-col md=\"12\">\n                        <v-text-field\n                            label=\"商品名\"\n                            :rules=\"formEmptyRule\"\n                            v-model=\"productForm.product_name\"\n                            clearable\n                        />\n                      </v-col>\n                    </v-row>\n                    <v-row>\n                      <v-col md=\"12\">\n                        <v-text-field\n                            label=\"商品品牌\"\n                            :rules=\"formEmptyRule\"\n                            v-model=\"productForm.product_brand\"\n                            clearable\n                        />\n                      </v-col>\n                    </v-row>\n                    <v-row>\n                      <v-col md=\"12\">\n                        <v-text-field\n                            label=\"商品颜色\"\n                            :rules=\"formEmptyRule\"\n                            v-model=\"productForm.product_color\"\n                            clearable\n                        />\n                      </v-col>\n                    </v-row>\n\n                    <v-row>\n                      <v-col md=\"12\">\n                        <v-text-field\n                            label=\"商品售价\"\n                            :rules=\"costRule\"\n                            v-model=\"productForm.product_cost\"\n                            clearable\n                        />\n                      </v-col>\n                    </v-row>\n                    <!--\n                    <v-row>\n                      <v-col md=\"12\">\n                        <v-text-field\n                            label=\"商品库存\"\n                            :rules=\"formEmptyRule\"\n                            clearable\n                        />\n                      </v-col>\n                    </v-row>\n                    !-->\n                  </v-container>\n                </v-form>\n              </v-col>\n              <v-col md=\"6\">\n                <el-form ref=\"form\" :model=\"productForm\" label-width=\"80px\">\n                  <el-form-item label=\"主页图片\">\n                    <input type=\"file\" @change=\"getImageFile1\" id=\"img\">\n                    <img :src=\"showPic1\" height=\"150px\" width=\"150px\"/>\n                  </el-form-item>\n\n                </el-form>\n                <el-form ref=\"form\" :model=\"productForm\" label-width=\"80px\">\n                  <el-form-item label=\"细节图片\">\n                    <input type=\"file\" @change=\"getImageFile2\" id=\"img\">\n                    <img :src=\"showPic2\" height=\"150px\" width=\"150px\"/>\n                  </el-form-item>\n\n                </el-form>\n              </v-col>\n            </v-row>\n            <v-divider/>\n            <v-row justify=\"end\">\n              <v-col md=\"4\" align=\"end\">\n                <v-btn\n                    small\n                    tile\n                    class=\"mr-2\"\n                    color=\"primary\"\n                    @click=\"saveProduct\"\n                >\n                  添加\n                </v-btn>\n              </v-col>\n            </v-row>\n          </v-card>\n        </v-card>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n\n<script>\nimport {required} from \"@/utils/widget\";\n\nexport default {\n  name: \"business_add_commodity\",\n  data() {\n    return {\n      productForm: {\n        product_name: \"\", // 商品名\n        product_color: \"\", // 商品颜色\n        // TODO：商品进价/商品售价\n        product_brand: \"\", // 商品库存\n        product_cost: \"\", // 商品库存\n        product_image1: 'http://127.0.0.1:8000/media/avatar/default_pic.jpg', // 主页图片\n        product_image2: 'http://127.0.0.1:8000/media/avatar/default_pic.jpg'\n        // TODO：细节图片\n      },\n      showPic1:'http://127.0.0.1:8000/media/avatar/default_pic.jpg',\n      showPic2:'http://127.0.0.1:8000/media/avatar/default_pic.jpg',\n      formEmptyRule: [required(\"此栏目\")],\n      costRule:[required(\"此栏目\"),\n          function (v) {\n            return  /^(([1-9]{1}\\d*)|(0{1}))(\\.\\d{1,2})?$/.test(v) || `金额最多两位小数`;\n          }\n      ]\n\n    };\n  },\n\n  methods: {\n    // TODO：保存商品信息\n    async saveProduct() {\n      let formData = new FormData();\n        formData.append('product_image1', this.productForm.product_image1);\n        formData.append('product_image2', this.productForm.product_image2);\n\n        const json = JSON.stringify(this.productForm);\n        const blob = new Blob([json], {\n          type: 'application/json'\n        });\n\n        formData.append('forms',blob)\n\n        const json2 = JSON.stringify((this.$store.state.userId));\n        const blob2 = new Blob([json2], {\n          type: 'application/json'\n        });\n\n        formData.append('user_id',blob2)\n        console.log(\"blob2\")\n        console.log(blob2)\n        console.log(JSON.stringify((this.$store.state.user_id)))\n\n        var configs = {\n          headers:{'Content-Type':'multipart/form-data'}\n        }\n\n        await this.axios.post('add_product/',formData, configs).then(response => {\n          console.log(formData.get('forms'))\n        if(response.data.msg===\"success\"){\n          //this.showPic1 = 'http://127.0.0.1:8000/media/'+response.data.image1\n          //this.showPic2 = 'http://127.0.0.1:8000/media/'+response.data.image2\n          console.log(response)\n\n\n\n\n          window.location.href = '/#/business/commodity';\n          window.alert(\"商品成功上架\")\n\n          }\n        console.log(response)\n        })\n        .catch(function (error) {\n            console.log(error);\n        });\n\n    },\n    getImageFile1:function(e) {\n       this.productForm.product_image1 = e.target.files[0];\n      let img = new FileReader();\n      img.readAsDataURL(this.productForm.product_image1);\n      console.log(\"img:\",img)\n      img.onload = ({ target }) => {\n        this.showPic1 = target.result; //将img转化为二进制数据\n        console.log(\"target:\",target)\n      };\n    },\n    getImageFile2:function(e) {\n       this.productForm.product_image2 = e.target.files[0];\n      let img = new FileReader();\n      img.readAsDataURL(this.productForm.product_image2);\n      console.log(\"img:\",img)\n      img.onload = ({ target }) => {\n        this.showPic2 = target.result; //将img转化为二进制数据\n        console.log(\"target:\",target)\n      };\n    },\n    async onSubmit(){\n      console.log(\"good\");\n    },\n    clear(){\n      this.productForm={\n        product_name: \"\", // 商品名\n        product_color: \"\", // 商品颜色\n        // TODO：商品进价/商品售价\n        product_brand: \"\", // 商品库存\n        product_cost: \"\", // 商品库存\n        product_image1: \"\", // 主页图片\n        product_image2: \"\"\n        // TODO：细节图片\n      },\n      this.showPic1=\"\",\n      this.showPic2=\"\"\n    }\n  },\n};\n</script>\n\n<style>\n\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}